self.webpackChunkRemoteClient([10],{104:function(t,e,n){"use strict";function r(t){return"date"===t.type||"esriFieldTypeDate"===t.type}function i(t){return t.toLowerCase().trim()}e.a=class{constructor(t){if(this.fields=t,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],!t)return;const e=[];for(const n of t){const t=n&&n.name;if(t){const s=i(t);this._fieldsMap.set(t,n),this._fieldsMap.set(s,n),e.push(s),r(n)&&(this.dateFields.push(n),this._dateFieldsSet.add(n))}}e.sort(),this.uid=e.join(",")}destroy(){this._fieldsMap.clear()}has(t){return null!=this.get(t)}get(t){return null!=t?this._fieldsMap.get(t)||this._fieldsMap.get(i(t)):void 0}isDateField(t){return this._dateFieldsSet.has(this.get(t))}normalizeFieldName(t){const e=this.get(t);if(e)return e.name}}},105:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return o})),n.d(e,"i",(function(){return p})),n.d(e,"j",(function(){return f})),n.d(e,"k",(function(){return u}));var r=n(37),i=n(70);function s(t=g){return[t[0],t[1],t[2],t[3]]}function o(t,e,n,r,i=s()){return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function a(t,e=s()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function u(t,e){return new i.a({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function c(t,e,n=t){if("length"in e)p(e)?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.max(t[2],e[2]),n[3]=Math.max(t[3],e[3])):2!==e.length&&3!==e.length||(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.max(t[2],e[0]),n[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":n[0]=Math.min(t[0],e.xmin),n[1]=Math.min(t[1],e.ymin),n[2]=Math.max(t[2],e.xmax),n[3]=Math.max(t[3],e.ymax);break;case"point":n[0]=Math.min(t[0],e.x),n[1]=Math.min(t[1],e.y),n[2]=Math.max(t[2],e.x),n[3]=Math.max(t[3],e.y);break;default:Object(r.a)(e)}return n}function l(t,e,n=t){const r=e.length;let i=t[0],s=t[1],o=t[2],a=t[3];for(let t=0;t<r;t++){const n=e[t];i=Math.min(i,n[0]),s=Math.min(s,n[1]),o=Math.max(o,n[0]),a=Math.max(a,n[1])}return n[0]=i,n[1]=s,n[2]=o,n[3]=a,n}function h(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function f(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function d(t){return t?f(t,m):s(m)}function p(t){return 4===t.length}const m=[1/0,1/0,-1/0,-1/0],g=[0,0,0,0]},139:function(t,e,n){"use strict";n.d(e,"a",(function(){return L})),n.d(e,"b",(function(){return $})),n.d(e,"c",(function(){return Z})),n.d(e,"d",(function(){return U})),n.d(e,"e",(function(){return k})),n.d(e,"f",(function(){return z})),n.d(e,"g",(function(){return H})),n.d(e,"h",(function(){return V})),n.d(e,"i",(function(){return F})),n.d(e,"j",(function(){return x})),n.d(e,"k",(function(){return D})),n.d(e,"l",(function(){return G})),n.d(e,"m",(function(){return at})),n.d(e,"n",(function(){return K})),n.d(e,"o",(function(){return nt})),n.d(e,"p",(function(){return ot})),n.d(e,"q",(function(){return J})),n.d(e,"r",(function(){return W})),n.d(e,"s",(function(){return _})),n.d(e,"t",(function(){return y})),n.d(e,"u",(function(){return it})),n.d(e,"v",(function(){return rt}));var r=n(7),i=n(10),s=n(73),o=n(203),a=n(261),u=n(163);function c(t,e){return t?e?4:3:e?3:2}const l=r.a.getLogger("esri.tasks.support.optimizedFeatureSet"),h={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},f=(t,e,n,r,i,s)=>{t[n]=i,t[n+1]=s},d=(t,e,n,r,i,s)=>{t[n]=i,t[n+1]=s,t[n+2]=e[r+2]},p=(t,e,n,r,i,s)=>{t[n]=i,t[n+1]=s,t[n+2]=e[r+3]},m=(t,e,n,r,i,s)=>{t[n]=i,t[n+1]=s,t[n+2]=e[r+2],t[n+3]=e[r+3]};function g(t,e,n,r){if(t){if(n)return e&&r?m:d;if(e&&r)return p}else if(e&&r)return d;return f}function _({scale:t,translate:e},n){return Math.round((n-e[0])/t[0])}function y({scale:t,translate:e},n){return Math.round((e[1]-n)/t[1])}function b({scale:t,translate:e},n){return n*t[0]+e[0]}function P({scale:t,translate:e},n){return e[1]-n*t[1]}function x(t,e,n){return t?e?n?T(t):M(t):n?E(t):I(t):null}function I(t){const e=t.coords;return{x:e[0],y:e[1]}}function S(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t}function M(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2]}}function O(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t}function E(t){const e=t.coords;return{x:e[0],y:e[1],m:e[2]}}function w(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.m,t}function T(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2],m:e[3]}}function j(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t.coords[3]=e.m,t}function N(t,e){return t&&e?j:t?O:e?w:S}function R(t,e,n,r,i){const s=N(n,r);for(const n of e){const{geometry:e,attributes:r}=n;let a;e&&(a=s(new u.a,e)),t.push(new o.a(a,r,null,r[i]))}return t}function F(t,e,n){if(!t)return null;const r=c(e,n),i=[];for(let e=0;e<t.coords.length;e+=r){const n=[];for(let i=0;i<r;i++)n.push(t.coords[e+i]);i.push(n)}return e?n?{points:i,hasZ:e,hasM:n}:{points:i,hasZ:e}:n?{points:i,hasM:n}:{points:i}}function v(t,e,n,r,i){const s=c(n,r);for(const n of e){const e=n.geometry,r=n.attributes;let a;e&&(a=A(new u.a,e,s)),t.push(new o.a(a,r,null,r[i]))}return t}function A(t,e,n=c(e.hasZ,e.hasM)){t.lengths[0]=e.points.length;const r=t.coords;let i=0;for(const t of e.points)for(let e=0;e<n;e++)r[i++]=t[e];return t}function G(t,e,n){if(!t)return null;const r=c(e,n),{coords:i,lengths:s}=t,o=[];let a=0;for(const t of s){const e=[];for(let n=0;n<t;n++){const t=[];for(let e=0;e<r;e++)t.push(i[a++]);e.push(t)}o.push(e)}return e?n?{paths:o,hasZ:e,hasM:n}:{paths:o,hasZ:e}:n?{paths:o,hasM:n}:{paths:o}}function C(t,e,n,r,i){const s=c(n,r);for(const n of e){const e=n.geometry,r=n.attributes;let a;e&&(a=B(new u.a,e,s)),t.push(new o.a(a,r,null,r[i]))}return t}function B(t,e,n=c(e.hasZ,e.hasM)){const{lengths:r,coords:i}=t;let s=0;for(const t of e.paths){for(const e of t)for(let t=0;t<n;t++)i[s++]=e[t];r.push(t.length)}return t}function D(t,e,n){if(!t)return null;const r=c(e,n),{coords:i,lengths:s}=t,o=[];let a=0;for(const t of s){const e=[];for(let n=0;n<t;n++){const t=[];for(let e=0;e<r;e++)t.push(i[a++]);e.push(t)}o.push(e)}return e?n?{rings:o,hasZ:e,hasM:n}:{rings:o,hasZ:e}:n?{rings:o,hasM:n}:{rings:o}}function Y(t,e,n,r,i){for(const s of e){const e=s.geometry,a=s.centroid,c=s.attributes;let l;e&&(l=k(new u.a,e,n,r)),a?t.push(new o.a(l,c,S(new u.a,a),c[i])):t.push(new o.a(l,c,null,c[i]))}return t}function k(t,e,n=e.hasZ,r=e.hasM){return function(t,e,n,r){const i=c(n,r),{lengths:s,coords:o}=t;let a=0;s.length=o.length=0;for(const t of e){for(const e of t)for(let t=0;t<i;t++)o[a++]=e[t];s.push(t.length)}}(t,e.rings,n,r),t}const Q=[],X=[];function L(t,e,n,r,i){Q[0]=t;const[s]=Z(X,Q,e,n,r,i);return Q.length=X.length=0,s}function Z(t,e,n,r,s,a){if(t.length=0,!n){for(const n of e){const e=n.attributes[a];t.push(new o.a(null,n.attributes,null,e))}return t}switch(n){case"esriGeometryPoint":return R(t,e,r,s,a);case"esriGeometryMultipoint":return v(t,e,r,s,a);case"esriGeometryPolyline":return C(t,e,r,s,a);case"esriGeometryPolygon":return Y(t,e,r,s,a);default:l.error("convertToFeatureSet:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${n}'`)),t.length=0}return t}function z(t,e,n,r){X[0]=t,q(Q,X,e,n,r);const i=Q[0];return Q.length=X.length=0,i}function U(t,e,n){if(!t)return null;const r=new u.a;return"hasZ"in t&&null==e&&(e=t.hasZ),"hasM"in t&&null==n&&(n=t.hasM),Object(s.f)(t)?N(null!=e?e:null!=t.z,null!=n?n:null!=t.m)(r,t):Object(s.g)(t)?k(r,t,e,n):Object(s.h)(t)?B(r,t,c(e,n)):Object(s.e)(t)?A(r,t,c(e,n)):void l.error("convertFromGeometry:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${t}'`))}function V(t,e,n,r){const s=t&&("coords"in t?t:t.geometry);if(!s)return null;switch(e){case"esriGeometryPoint":{let t=I;return n&&r?t=T:n?t=M:r&&(t=E),t(s)}case"esriGeometryMultipoint":return F(s,n,r);case"esriGeometryPolyline":return G(s,n,r);case"esriGeometryPolygon":return D(s,n,r);default:return void l.error("convertToGeometry:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${e}'`))}}function q(t,e,n,r,s){switch(t.length=0,n){case"esriGeometryPoint":return function(t,e,n,r){let i=I;n&&r?i=T:n?i=M:r&&(i=E);for(const n of e){const{geometry:e,attributes:r}=n,s=e?i(e):null;t.push({attributes:r,geometry:s})}return t}(t,e,r,s);case"esriGeometryMultipoint":return function(t,e,n,r){for(const i of e){const{geometry:e,attributes:s}=i;let o;e&&(o=F(e,n,r)),t.push({attributes:s,geometry:o})}return t}(t,e,r,s);case"esriGeometryPolyline":return function(t,e,n,r){for(const i of e){const{geometry:e,attributes:s}=i;let o;e&&(o=G(e,n,r)),t.push({attributes:s,geometry:o})}return t}(t,e,r,s);case"esriGeometryPolygon":return function(t,e,n,r){for(const i of e){const{geometry:e,attributes:s,centroid:o}=i;let a;if(e&&(a=D(e,n,r)),o){const e=I(o);t.push({attributes:s,centroid:e,geometry:a})}else t.push({attributes:s,geometry:a})}return t}(t,e,r,s);default:l.error("convertToFeatureSet:unknown-geometry",new i.a(`Unable to parse unknown geometry type '${n}'`))}return t}function H(t){const{objectIdFieldName:e,spatialReference:n,transform:r,fields:i,hasM:s,hasZ:o,features:a,geometryType:u,exceededTransferLimit:c,uniqueIdField:l,serverGens:h,queryGeometry:f,queryGeometryType:d}=t,p={features:q([],a,u,o,s),fields:i,geometryType:u,objectIdFieldName:e,spatialReference:n,uniqueIdField:l,serverGens:h,queryGeometry:V(f,d,!1,!1)};return r&&(p.transform=r),c&&(p.exceededTransferLimit=c),s&&(p.hasM=s),o&&(p.hasZ=o),p}function $(t,e){const n=new a.a,{hasM:r,hasZ:s,features:o,objectIdFieldName:u,spatialReference:c,geometryType:h,exceededTransferLimit:f,transform:d}=t;return n.fields=t.fields,n.geometryType=h,n.objectIdFieldName=u||e,n.spatialReference=c,n.objectIdFieldName?(o&&Z(n.features,o,h,s,r,n.objectIdFieldName),f&&(n.exceededTransferLimit=f),r&&(n.hasM=r),s&&(n.hasZ=s),d&&(n.transform=d),n):(l.error(new i.a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),n)}function J(t,e){const{geometryType:n,features:r,hasM:i,hasZ:s}=e;if(!t)return e;for(let e=0;e<r.length;e++){const o=r[e],a=o.weakClone();a.geometry=new u.a,W(a.geometry,o.geometry,i,s,n,t),o.centroid&&(a.centroid=new u.a,W(a.centroid,o.centroid,i,s,"esriGeometryPoint",t)),r[e]=a}return e.transform=t,e}function W(t,e,n,r,i,s,o=n,a=r){if(t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0),!e||!e.coords.length)return null;const u=h[i],{coords:l,lengths:f}=e,d=c(n,r),p=c(n&&o,r&&a),m=g(n,r,o,a);if(!f.length)return m(t.coords,l,0,0,_(s,l[0]),y(s,l[1])),t.lengths.length&&(t.lengths.length=0),t.coords.length=d,t;let b,P,x,I,S=0,M=0,O=M;for(const e of f){if(e<u)continue;let n=0;M=O,x=b=_(s,l[S]),I=P=y(s,l[S+1]),m(t.coords,l,M,S,x,I),n++,S+=d,M+=p;for(let r=1;r<e;r++,S+=d)x=_(s,l[S]),I=y(s,l[S+1]),x===b&&I===P||(m(t.coords,l,M,S,x-b,I-P),M+=p,n++,b=x,P=I);n>=u&&(t.lengths.push(n),O=M)}return t.coords.length=O,t.coords.length?t:null}function K(t,e,n,r,i,s,o=n,a=r){if(t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0),!e||!e.coords.length)return null;const u=h[i],{coords:l,lengths:f}=e,d=c(n,r),p=c(n&&o,r&&a),m=g(n,r,o,a);if(!f.length)return m(t.coords,l,0,0,l[0],l[1]),t.lengths.length&&(t.lengths.length=0),t.coords.length=d,t;let _=0;const y=s*s;for(const e of f){if(e<u){_+=e*d;continue}const n=t.coords.length/p,r=_,i=_+(e-1)*d;m(t.coords,l,t.coords.length,r,l[r],l[r+1]),et(t.coords,l,d,y,m,r,i),m(t.coords,l,t.coords.length,i,l[i],l[i+1]);const s=t.coords.length/p-n;s>=u?t.lengths.push(s):t.coords.length=n*p,_+=e*d}return t.coords.length?t:null}function tt(t,e,n,r){const i=t[e],s=t[e+1],o=t[n],a=t[n+1],u=t[r],c=t[r+1];let l=o,h=a,f=u-l,d=c-h;if(0!==f||0!==d){const t=((i-l)*f+(s-h)*d)/(f*f+d*d);t>1?(l=u,h=c):t>0&&(l+=f*t,h+=d*t)}return f=i-l,d=s-h,f*f+d*d}function et(t,e,n,r,i,s,o){let a,u=r,c=0;for(let t=s+n;t<o;t+=n)a=tt(e,t,s,o),a>u&&(c=t,u=a);u>r&&(c-s>n&&et(t,e,n,r,i,s,c),i(t,e,t.length,c,e[c],e[c+1]),o-c>n&&et(t,e,n,r,i,c,o))}function nt(t,e,n,r){if(!e||!e.coords||!e.coords.length)return null;const i=c(n,r);let s=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(e&&e.coords){const t=e.coords;for(let e=0;e<t.length;e+=i){const n=t[e],r=t[e+1];s=Math.min(s,n),a=Math.max(a,n),o=Math.min(o,r),u=Math.max(u,r)}}return t[0]=s,t[1]=o,t[2]=a,t[3]=u,t}function rt(t,e,n,r,i){const{coords:s,lengths:o}=e,a=n?r?m:d:r?d:f,u=c(n,r);if(!s.length)return t!==e&&(t.lengths.length=0,t.coords.length=0),t;if(!o.length)return a(t.coords,s,0,0,b(i,s[0]),P(i,s[1])),t!==e&&(t.lengths.length=0,t.coords.length=u),t;const[l,h]=i.scale;let p=0;for(let e=0;e<o.length;e++){const n=o[e];t.lengths[e]=n;let r=b(i,s[p]),c=P(i,s[p+1]);a(t.coords,s,p,p,r,c),p+=u;for(let e=1;e<n;e++,p+=u)r+=s[p]*l,c-=s[p+1]*h,a(t.coords,s,p,p,r,c)}return t!==e&&(t.lengths.length=o.length,t.coords.length=s.length),t}function it(t,e,n,r,i,s){const o=c(n,r),a=g(n,r,i,s),u=e.coords;t.coords.length=0,t.lengths.length=0,t.lengths.push(...e.lengths);for(let e=0;e<u.length;e+=o)a(t.coords,u,t.coords.length,e,u[e],u[e+1]);return t}function st(t,e,n,r){let i=0,s=t[r*e],o=t[r*(e+1)];for(let a=1;a<n;a++){const n=s+t[r*(e+a)],u=o+t[r*(e+a)+1],c=(n-s)*(u+o);s=n,o=u,i+=c}return.5*i}function ot(t,e){const{coords:n,lengths:r}=t;let i=0,s=0;for(let t=0;t<r.length;t++)s+=st(n,i,r[t],e),i+=t;return Math.abs(s)}function at(t,e){const n=t.clone(),r=t.coords,i=t.lengths;let s=0;for(let t=0;t<i.length;t++){const o=i[t];let a=r[e*s],u=r[e*s+1];for(let t=1;t<o;t++){const i=a+r[e*(s+t)],o=u+r[e*(s+t)+1];n.coords[e*(s+t)]=i,n.coords[e*(s+t)+1]=o,a=i,u=o}s+=o}return n}},148:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return c}));const r=[252,146,31,255],i={type:"esriSMS",style:"esriSMSCircle",size:6,color:r,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},s={type:"esriSLS",style:"esriSLSSolid",width:.75,color:r},o={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},a={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},l={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},163:function(t,e,n){"use strict";class r{constructor(t=[],e=[],n=!1){this.lengths=t,this.coords=e,this.hasIndeterminateRingOrder=n}get isPoint(){return 0===this.lengths.length}forEachVertex(t){let e=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let n=0;n<this.lengths.length;n++){const r=this.lengths[n];for(let n=0;n<r;n++)t(this.coords[2*(n+e)],this.coords[2*(n+e)+1]);e+=r}}clone(){return new r(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}e.a=r},186:function(t,e,n){"use strict";n.d(e,"a",(function(){return P})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return g})),n.d(e,"d",(function(){return b})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return _})),n.d(e,"h",(function(){return o})),n.d(e,"i",(function(){return m})),n.d(e,"j",(function(){return p})),n.d(e,"k",(function(){return d})),n.d(e,"l",(function(){return f}));var r=n(2),i=(n(70),n(105));function s(t=x){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function o(t,e,n,r,i,o,a=s()){return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=i,a[5]=o,a}function a(t,e,n=t){return y(e)?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.min(t[2],e[2]),n[3]=Math.max(t[3],e[3]),n[4]=Math.max(t[4],e[4]),n[5]=Math.max(t[5],e[5])):Object(i.i)(e)?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[3]=Math.max(t[3],e[2]),n[4]=Math.max(t[4],e[3])):2===e.length?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[3]=Math.max(t[3],e[0]),n[4]=Math.max(t[4],e[1])):3===e.length&&(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.min(t[2],e[2]),n[3]=Math.max(t[3],e[0]),n[4]=Math.max(t[4],e[1]),n[5]=Math.max(t[5],e[2])),n}function u(t,e,n,r=t){const i=e.length;let s=t[0],o=t[1],a=t[2],u=t[3],c=t[4],l=t[5];if(n)for(let t=0;t<i;t++){const n=e[t];s=Math.min(s,n[0]),o=Math.min(o,n[1]),a=Math.min(a,n[2]),u=Math.max(u,n[0]),c=Math.max(c,n[1]),l=Math.max(l,n[2])}else for(let t=0;t<i;t++){const n=e[t];s=Math.min(s,n[0]),o=Math.min(o,n[1]),u=Math.max(u,n[0]),c=Math.max(c,n[1])}return r[0]=s,r[1]=o,r[2]=a,r[3]=u,r[4]=c,r[5]=l,r}function c(t){return t[0]>=t[3]?0:t[3]-t[0]}function l(t){return t[1]>=t[4]?0:t[4]-t[1]}function h(t){return t[2]>=t[5]?0:t[5]-t[2]}function f(t,e=[0,0,0]){return e[0]=c(t),e[1]=l(t),e[2]=h(t),e}function d(t,e,n=t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n!==t&&(n[3]=t[3],n[4]=t[4],n[5]=t[5]),n}function p(t,e,n=t){return n[3]=e[0],n[4]=e[1],n[5]=e[2],n!==t&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),t}function m(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function g(t){return t?m(t,P):s(P)}function _(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function y(t){return 6===t.length}function b(t,e,n){if(Object(r.g)(t)||Object(r.g)(e))return t===e;if(!y(t)||!y(e))return!1;if(n){for(let r=0;r<t.length;r++)if(!n(t[r],e[r]))return!1}else for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const P=[1/0,1/0,1/0,-1/0,-1/0,-1/0],x=[0,0,0,0,0,0];s()},203:function(t,e,n){"use strict";class r{constructor(t=null,e={},n,r){this.displayId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=t,e&&(this.attributes=e),n&&(this.centroid=n),null!=r&&(this.objectId=r)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const t=new r(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashIndexed=this.geohashIndexed,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}}e.a=r},211:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return _})),n.d(e,"c",(function(){return b}));var r=n(10),i=n(5),s=n(89),o=n(138),a=n(260),u=n(322);const c=[0,0];function l(t,e){if(!e)return null;if("x"in e){const n={x:0,y:0};return[n.x,n.y]=t(e.x,e.y,c),null!=e.z&&(n.z=e.z),null!=e.m&&(n.m=e.m),n}if("xmin"in e){const n={xmin:0,ymin:0,xmax:0,ymax:0};return[n.xmin,n.ymin]=t(e.xmin,e.ymin,c),[n.xmax,n.ymax]=t(e.xmax,e.ymax,c),e.hasZ&&(n.zmin=e.zmin,n.zmax=e.zmax,n.hasZ=!0),e.hasM&&(n.mmin=e.mmin,n.mmax=e.mmax,n.hasM=!0),n}return"rings"in e?{rings:h(e.rings,t),hasM:e.hasM,hasZ:e.hasZ}:"paths"in e?{paths:h(e.paths,t),hasM:e.hasM,hasZ:e.hasZ}:"points"in e?{points:f(e.points,t),hasM:e.hasM,hasZ:e.hasZ}:void 0}function h(t,e){const n=[];for(const r of t)n.push(f(r,e));return n}function f(t,e){const n=[];for(const r of t){const t=e(r[0],r[1],[0,0]);n.push(t),r.length>2&&t.push(r[2]),r.length>3&&t.push(r[3])}return n}async function d(t,e){if(e)if(Array.isArray(t)){for(const n of t)if(p(n.geometry&&n.geometry.spatialReference,e)){if(Object(u.b)())return Object(u.c)();throw new r.a("feature-store:unsupported-query","projection not supported",{inSpatialReference:t,outSpatialReference:e})}}else if(p(t,e)){if(Object(u.b)())return Object(u.c)();throw new r.a("feature-store:unsupported-query","projection not supported",{inSpatialReference:t,outSpatialReference:e})}}function p(t,e){return!(!Object(s.f)(t)||!Object(s.f)(e)||Object(s.c)(t,e)||Object(o.a)(t,e))}const m=l.bind(null,o.c),g=l.bind(null,o.f);function _(t,e,n){return t?(n||(n=e,e=t.spatialReference),Object(s.f)(e)&&Object(s.f)(n)&&!Object(s.c)(e,n)?Object(o.a)(e,n)?Object(s.h)(n)?m(t):g(t):Object(u.e)(a.a,[t],e,n,null)[0]:t):t}const y=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(t,e,n){!t||!t.length||!e||!n||Object(s.c)(e,n);const r={geometries:t,inSpatialReference:e,outSpatialReference:n,resolve:null};return this._jobs.push(r),Object(i.f)(t=>{r.resolve=t,null===this._timer&&(this._timer=setTimeout(this._process,10))})}_process(){this._timer=null;const t=this._jobs.shift();if(!t)return;const{geometries:e,inSpatialReference:n,outSpatialReference:r,resolve:i}=t;Object(o.a)(n,r)?Object(s.h)(r)?i(e.map(m)):i(e.map(g)):i(Object(u.e)(a.a,e,n,r,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};async function b(t,e,n){return y.push(t,e,n)}},260:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={convertToGEGeometry:function(t,e){return null==e?null:t.convertJSONToGeometry(e)},exportPoint:function(t,e,n){const r=new i(t.getPointX(e),t.getPointY(e),n),s=t.hasZ(e),o=t.hasM(e);return s&&(r.z=t.getPointZ(e)),o&&(r.m=t.getPointM(e)),r},exportPolygon:function(t,e,n){return new s(t.exportPaths(e),n,t.hasZ(e),t.hasM(e))},exportPolyline:function(t,e,n){return new o(t.exportPaths(e),n,t.hasZ(e),t.hasM(e))},exportMultipoint:function(t,e,n){return new a(t.exportPoints(e),n,t.hasZ(e),t.hasM(e))},exportExtent:function(t,e,n){const r=t.hasZ(e),i=t.hasM(e),s=new u(t.getXMin(e),t.getYMin(e),t.getXMax(e),t.getYMax(e),n);if(r){const n=t.getZExtent(e);s.zmin=n.vmin,s.zmax=n.vmax}if(i){const n=t.getMExtent(e);s.mmin=n.vmin,s.mmax=n.vmax}return s}};class i{constructor(t,e,n){this.x=t,this.y=e,this.spatialReference=n,this.z=void 0,this.m=void 0}}class s{constructor(t,e,n,r){this.rings=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class o{constructor(t,e,n,r){this.paths=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class a{constructor(t,e,n,r){this.points=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class u{constructor(t,e,n,r,i){this.xmin=t,this.ymin=e,this.xmax=n,this.ymax=r,this.spatialReference=i,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},261:function(t,e,n){"use strict";class r{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.serverGens=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const t=new r;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}e.a=r},271:function(t,e,n){"use strict";function r(t,e){return t?e?4:3:e?3:2}function i(t,e,n,i,a){if(!e||!e.lengths.length)return null;const u="upperLeft"===(null==a?void 0:a.originPosition)?-1:1;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const c=t.coords,l=[],h=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:d}=e,p=r(n,i);let m=0;for(const t of f){const e=s(h,d,m,t,n,i,u);e&&l.push(e),m+=t*p}if(l.sort((t,e)=>{let r=u*t[2]-u*e[2];return 0===r&&n&&(r=t[4]-e[4]),r}),l.length){let t=6*l[0][2];c[0]=l[0][0]/t,c[1]=l[0][1]/t,n&&(t=6*l[0][4],c[2]=0!==t?l[0][3]/t:0),(c[0]<h[0]||c[0]>h[1]||c[1]<h[2]||c[1]>h[3]||n&&(c[2]<h[4]||c[2]>h[5]))&&(c.length=0)}if(!c.length){const t=e.lengths[0]?o(d,0,f[0],n,i):null;if(!t)return null;c[0]=t[0],c[1]=t[1],n&&t.length>2&&(c[2]=t[2])}return t}function s(t,e,n,i,s,o,a=1){const u=r(s,o);let c=n,l=n+u,h=0,f=0,d=0,p=0,m=0;for(let n=0,r=i-1;n<r;n++,c+=u,l+=u){const n=e[c],r=e[c+1],i=e[c+2],o=e[l],a=e[l+1],u=e[l+2];let g=n*a-o*r;p+=g,h+=(n+o)*g,f+=(r+a)*g,s&&(g=n*u-o*i,d+=(i+u)*g,m+=g),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),s&&(i<t[4]&&(t[4]=i),i>t[5]&&(t[5]=i))}if(p*a>0&&(p*=-1),m*a>0&&(m*=-1),!p)return null;const g=[h,f,.5*p];return s&&(g[3]=d,g[4]=.5*m),g}function o(t,e,n,i,s){const o=r(i,s);let h=e,f=e+o,d=0,p=0,m=0,g=0;for(let e=0,r=n-1;e<r;e++,h+=o,f+=o){const e=t[h],n=t[h+1],r=t[h+2],s=t[f],o=t[f+1],_=t[f+2],y=i?u(e,n,r,s,o,_):a(e,n,s,o);if(y)if(d+=y,i){const t=l(e,n,r,s,o,_);p+=y*t[0],m+=y*t[1],g+=y*t[2]}else{const t=c(e,n,s,o);p+=y*t[0],m+=y*t[1]}}return d>0?i?[p/d,m/d,g/d]:[p/d,m/d]:n>0?i?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function a(t,e,n,r){const i=n-t,s=r-e;return Math.sqrt(i*i+s*s)}function u(t,e,n,r,i,s){const o=r-t,a=i-e,u=s-n;return Math.sqrt(o*o+a*a+u*u)}function c(t,e,n,r){return[t+.5*(n-t),e+.5*(r-e)]}function l(t,e,n,r,i,s){return[t+.5*(r-t),e+.5*(i-e),n+.5*(s-n)]}n.d(e,"a",(function(){return i}))},293:function(t,e,n){"use strict";function r(t,e){if(!t)return null;const n=e.featureAdapter,{startTimeField:r,endTimeField:i}=t;let s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(r&&i)e.forEach(t=>{const e=n.getAttribute(t,r),a=n.getAttribute(t,i);null==e||isNaN(e)||(s=Math.min(s,e)),null==a||isNaN(a)||(o=Math.max(o,a))});else{const t=r||i;e.forEach(e=>{const r=n.getAttribute(e,t);null==r||isNaN(r)||(s=Math.min(s,r),o=Math.max(o,r))})}return{start:s,end:o}}function i(t,e,n){if(!e||!t)return null;const{startTimeField:r,endTimeField:i}=t;if(!r&&!i)return null;const{start:s,end:o}=e;return null===s&&null===o?null:void 0===s&&void 0===o?()=>!1:r&&i?function(t,e,n,r,i){return null!=r&&null!=i?s=>{const o=t.getAttribute(s,e),a=t.getAttribute(s,n);return(null==o||o<=i)&&(null==a||a>=r)}:null!=r?e=>{const i=t.getAttribute(e,n);return null==i||i>=r}:null!=i?n=>{const r=t.getAttribute(n,e);return null==r||r<=i}:void 0}(n,r,i,s,o):function(t,e,n,r){return null!=n&&null!=r&&n===r?r=>t.getAttribute(r,e)===n:null!=n&&null!=r?i=>{const s=t.getAttribute(i,e);return s>=n&&s<=r}:null!=n?r=>t.getAttribute(r,e)>=n:null!=r?n=>t.getAttribute(n,e)<=r:void 0}(n,r||i,s,o)}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},294:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return p}));n(73);const r=(t,e,n)=>[e,n],i=(t,e,n)=>[e,n,t[2]],s=(t,e,n)=>[e,n,t[2],t[3]];function o(t){return t?{originPosition:"upper-left"===t.originPosition?"upperLeft":"lower-left"===t.originPosition?"lowerLeft":t.originPosition,scale:[t.tolerance,t.tolerance],translate:[t.extent.xmin,t.extent.ymax]}:null}function a({scale:t,translate:e},n){return n*t[0]+e[0]}function u({scale:t,translate:e},n){return e[1]-n*t[1]}function c(t,e,n){const r=new Array(n.length);if(!n.length)return r;const[i,s]=t.scale;let o=a(t,n[0][0]),c=u(t,n[0][1]);r[0]=e(n[0],o,c);for(let t=1;t<n.length;t++){const a=n[t];o+=a[0]*i,c-=a[1]*s,r[t]=e(a,o,c)}return r}function l(t,e,n){const r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=c(t,e,n[i]);return r}function h(t,e,n,o,a){return e.points=function(t,e,n,o){return c(t,n?o?s:i:o?i:r,e)}(t,n.points,o,a),e}function f(t,e,n,r,i){return e.x=a(t,n.x),e.y=u(t,n.y),e!==n&&(r&&(e.z=n.z),i&&(e.m=n.m)),e}function d(t,e,n,o,a){return e.rings=function(t,e,n,o){return l(t,n?o?s:i:o?i:r,e)}(t,n.rings,o,a),e}function p(t,e,n,o,a){return e.paths=function(t,e,n,o){return l(t,n?o?s:i:o?i:r,e)}(t,n.paths,o,a),e}},322:function(t,e,n){"use strict";n.d(e,"a",(function(){return D})),n.d(e,"b",(function(){return Y})),n.d(e,"c",(function(){return Q})),n.d(e,"d",(function(){return X})),n.d(e,"e",(function(){return Z}));n(20);var r=n(5),i=n(3),s=n(143);let o,a=null;function u(){return!!a}function c(){return!!Object(i.a)("esri-wasm")}function l(){return o||(o=Object(r.f)((t,e)=>{n.e(71).then(n.bind(null,554)).then((function(t){return t.p})).then(({default:n})=>{n({locateFile:t=>Object(s.b)("esri/geometry/support/"+t),onAbort:t=>{e(new Error(t))}}).then(e=>{O(e),t()})})}),o)}var h,f,d,p;!function(t){function e(t,e,n){a.ensureCache.prepare();const r=T(n),i=n===r,s=a.ensureFloat64(r),o=a._pe_geog_to_proj(a.getPointer(t),e,s);return o&&j(n,e,s,i),o}function n(t,e,n){return r(t,e,n,0)}function r(t,e,n,r){a.ensureCache.prepare();const i=T(n),s=n===i,o=a.ensureFloat64(i),u=a._pe_proj_to_geog_center(a.getPointer(t),e,o,r);return u&&j(n,e,o,s),u}t.geogToProj=e,t.projGeog=function(t,r,i,s){switch(s){case f.PE_TRANSFORM_P_TO_G:return n(t,r,i);case f.PE_TRANSFORM_G_TO_P:return e(t,r,i)}return 0},t.projToGeog=n,t.projToGeogCenter=r}(h||(h={})),(p=f||(f={})).init=function(){p.PE_BUFFER_MAX=a.PeDefs.prototype.PE_BUFFER_MAX,p.PE_NAME_MAX=a.PeDefs.prototype.PE_NAME_MAX,p.PE_MGRS_MAX=a.PeDefs.prototype.PE_MGRS_MAX,p.PE_USNG_MAX=a.PeDefs.prototype.PE_USNG_MAX,p.PE_DD_MAX=a.PeDefs.prototype.PE_DD_MAX,p.PE_DDM_MAX=a.PeDefs.prototype.PE_DDM_MAX,p.PE_DMS_MAX=a.PeDefs.prototype.PE_DMS_MAX,p.PE_UTM_MAX=a.PeDefs.prototype.PE_UTM_MAX,p.PE_PARM_MAX=a.PeDefs.prototype.PE_PARM_MAX,p.PE_TYPE_NONE=a.PeDefs.prototype.PE_TYPE_NONE,p.PE_TYPE_GEOGCS=a.PeDefs.prototype.PE_TYPE_GEOGCS,p.PE_TYPE_PROJCS=a.PeDefs.prototype.PE_TYPE_PROJCS,p.PE_TYPE_GEOGTRAN=a.PeDefs.prototype.PE_TYPE_GEOGTRAN,p.PE_TYPE_COORDSYS=a.PeDefs.prototype.PE_TYPE_COORDSYS,p.PE_TYPE_UNIT=a.PeDefs.prototype.PE_TYPE_UNIT,p.PE_STR_OPTS_NONE=a.PeDefs.prototype.PE_STR_OPTS_NONE,p.PE_STR_AUTH_NONE=a.PeDefs.prototype.PE_STR_AUTH_NONE,p.PE_STR_AUTH_TOP=a.PeDefs.prototype.PE_STR_AUTH_TOP,p.PE_STR_NAME_CANON=a.PeDefs.prototype.PE_STR_NAME_CANON,p.PE_PARM_X0=a.PeDefs.prototype.PE_PARM_X0,p.PE_PARM_ND=a.PeDefs.prototype.PE_PARM_ND,p.PE_TRANSFORM_1_TO_2=a.PeDefs.prototype.PE_TRANSFORM_1_TO_2,p.PE_TRANSFORM_2_TO_1=a.PeDefs.prototype.PE_TRANSFORM_2_TO_1,p.PE_TRANSFORM_P_TO_G=a.PeDefs.prototype.PE_TRANSFORM_P_TO_G,p.PE_TRANSFORM_G_TO_P=a.PeDefs.prototype.PE_TRANSFORM_G_TO_P,p.PE_HORIZON_RECT=a.PeDefs.prototype.PE_HORIZON_RECT,p.PE_HORIZON_POLY=a.PeDefs.prototype.PE_HORIZON_POLY,p.PE_HORIZON_LINE=a.PeDefs.prototype.PE_HORIZON_LINE,p.PE_HORIZON_DELTA=a.PeDefs.prototype.PE_HORIZON_DELTA},function(t){const e={},n={};function r(t,n){let r=null,s=e[t];if(s||(s={},e[t]=s),s.hasOwnProperty(String(n)))r=s[n];else{const e=a.PeFactory.prototype.factoryByType(t,n);a.compare(e,a.NULL)||(r=e,s[n]=r)}return r=i(r),r}function i(t){if(t){const e=t.getType();switch(e){case f.PE_TYPE_GEOGCS:t=a.castObject(t,a.PeGeogcs);break;case f.PE_TYPE_PROJCS:t=a.castObject(t,a.PeProjcs);break;case f.PE_TYPE_GEOGTRAN:t=a.castObject(t,a.PeGeogtran);break;default:e&f.PE_TYPE_UNIT&&(t=a.castObject(t,a.PeUnit))}}return t}t.initialize=function(){a.PeFactory.prototype.initialize(null)},t.coordsys=function(t){return r(f.PE_TYPE_COORDSYS,t)},t.factoryByType=r,t.fromString=function(t,e){let r=null,s=n[t];if(s||(s={},n[t]=s),s.hasOwnProperty(e))r=s[e];else{const n=a.PeFactory.prototype.fromString(t,e);a.compare(n,a.NULL)||(r=n,s[e]=r)}return r=i(r),r},t.geogcs=function(t){return r(f.PE_TYPE_GEOGCS,t)},t.geogtran=function(t){return r(f.PE_TYPE_GEOGTRAN,t)},t.getCode=function(t){return a.PeFactory.prototype.getCode(t)},t.projcs=function(t){return r(f.PE_TYPE_PROJCS,t)},t.unit=function(t){return r(f.PE_TYPE_UNIT,t)}}(d||(d={}));let m=null;var g,_,y,b,P,x,I,S,M;function O(t){function e(t,e,n){t[e]=n(t[e])}a=t,f.init(),g.init(),P.init(),I.init(),S.init(),m=class extends a.PeGCSExtent{destroy(){a.destroy(this)}};const n=[a.PeDatum,a.PeGeogcs,a.PeGeogtran,a.PeObject,a.PeParameter,a.PePrimem,a.PeProjcs,a.PeSpheroid,a.PeUnit];for(const t of n)e(t.prototype,"getName",t=>function(){return t.call(this,new Array(f.PE_NAME_MAX))});for(const t of[a.PeGeogtran,a.PeProjcs])e(t.prototype,"getParameters",t=>function(){const e=new Array(f.PE_PARM_MAX);let n=t.call(this);for(let t=0;t<e.length;t++){const r=a.getValue(n,"*");e[t]=r?a.wrapPointer(r,a.PeParameter):null,n+=Int32Array.BYTES_PER_ELEMENT}return e});e(a.PeHorizon.prototype,"getCoord",t=>function(){const e=this.getSize();if(!e)return null;const n=[];return j(n,e,t.call(this)),n}),e(a.PeGTlistExtendedEntry.prototype,"getEntries",t=>{const e=a._pe_getPeGTlistExtendedGTsSize();return function(){let n=null;const r=t.call(this);if(!a.compare(r,a.NULL)){n=[r];const t=this.getSteps();if(t>1){const i=a.getPointer(r);for(let r=1;r<t;r++)n.push(a.wrapPointer(i+e*r,a.PeGTlistExtendedGTs))}}return n}});const r=a._pe_getPeHorizonSize(),i=t=>function(){let e=this._cache;if(e||(e=new Map,this._cache=e),e.has(t))return e.get(t);let n=null;const i=t.call(this);if(!a.compare(i,a.NULL)){n=[i];const t=i.getNump();if(t>1){const e=a.getPointer(i);for(let i=1;i<t;i++)n.push(a.wrapPointer(e+r*i,a.PeHorizon))}}return e.set(t,n),n};e(a.PeProjcs.prototype,"horizonGcsGenerate",i),e(a.PeProjcs.prototype,"horizonPcsGenerate",i),a.PeObject.prototype.toString=function(t=f.PE_STR_OPTS_NONE){a.ensureCache.prepare();const e=a.getPointer(this),n=a.ensureInt8(new Array(f.PE_BUFFER_MAX));return a.UTF8ToString(a._pe_object_to_string_ext(e,t,n))}}function E(t){if(!t)return;const e=a.getClass(t);if(!e)return;const n=a.getCache(e);if(!n)return;const r=a.getPointer(t);r&&delete n[r]}function w(t,e){const n=[],r=new Array(e);for(let e=0;e<t;e++)n.push(a.ensureInt8(r));return n}function T(t){let e;return Array.isArray(t[0])?(e=[],t.forEach(t=>{e.push(t[0],t[1])})):e=t,e}function j(t,e,n,r=!1){if(r)for(let r=0;r<2*e;r++)t[r]=a.getValue(n+r*Float64Array.BYTES_PER_ELEMENT,"double");else{const r=0===t.length;for(let i=0;i<e;i++)r&&(t[i]=new Array(2)),t[i][0]=a.getValue(n,"double"),t[i][1]=a.getValue(n+Float64Array.BYTES_PER_ELEMENT,"double"),n+=2*Float64Array.BYTES_PER_ELEMENT}}!function(t){let e;t.init=function(){t.PE_GTLIST_OPTS_COMMON=a.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=a._pe_getPeGTlistExtendedEntrySize()},t.getGTlist=function(t,n,r,i,s,o){let u=null;const c=new a.PeInteger(o);try{const l=a.PeGTlistExtended.prototype.getGTlist(t,n,r,i,s,c);if((o=c.val)&&(u=[l],o>1)){const t=a.getPointer(l);for(let n=1;n<o;n++)u.push(a.wrapPointer(t+e*n,a.PeGTlistExtendedEntry))}}finally{a.destroy(c)}return u}}(g||(g={})),function(t){t.destroy=function(t){if(t&&t.length){for(const e of t)E(e),e.getEntries().forEach(t=>{E(t);const e=t.getGeogtran();E(e),e.getParameters().forEach(E),[e.getGeogcs1(),e.getGeogcs2()].forEach(t=>{E(t);const e=t.getDatum();E(e),E(e.getSpheroid()),E(t.getPrimem()),E(t.getUnit())})});a.PeGTlistExtendedEntry.prototype.Delete(t[0])}}}(_||(_={})),function(t){t.geogToGeog=function(t,e,n,r,i){a.ensureCache.prepare();const s=T(n),o=n===s,u=a.ensureFloat64(s);let c=0;r&&(c=a.ensureFloat64(r));const l=a._pe_geog_to_geog(a.getPointer(t),e,u,c,i);return l&&j(n,e,u,o),l}}(y||(y={})),function(t){function e(t,e,n,r,i,s){let o,u;switch(a.ensureCache.prepare(),t){case"dd":o=a._pe_geog_to_dd,u=f.PE_DD_MAX;break;case"ddm":o=a._pe_geog_to_ddm,u=f.PE_DDM_MAX;break;case"dms":o=a._pe_geog_to_dms,u=f.PE_DMS_MAX}let c=0;e&&(c=a.getPointer(e));const l=T(r),h=a.ensureFloat64(l),d=w(n,u),p=o(c,n,h,i,a.ensureInt32(d));if(p)for(let t=0;t<n;t++)s[t]=a.UTF8ToString(d[t]);return p}function n(t,e,n,r,i){let s;switch(a.ensureCache.prepare(),t){case"dd":s=a._pe_dd_to_geog;break;case"ddm":s=a._pe_ddm_to_geog;break;case"dms":s=a._pe_dms_to_geog}let o=0;e&&(o=a.getPointer(e));const u=r.map(t=>a.ensureString(t)),c=a.ensureInt32(u),l=a.ensureFloat64(new Array(2*n)),h=s(o,n,c,l);return h&&j(i,n,l),h}t.geog_to_dms=function(t,n,r,i,s){return e("dms",t,n,r,i,s)},t.dms_to_geog=function(t,e,r,i){return n("dms",t,e,r,i)},t.geog_to_ddm=function(t,n,r,i,s){return e("ddm",t,n,r,i,s)},t.ddm_to_geog=function(t,e,r,i){return n("ddm",t,e,r,i)},t.geog_to_dd=function(t,n,r,i,s){return e("dd",t,n,r,i,s)},t.dd_to_geog=function(t,e,r,i){return n("dd",t,e,r,i)}}(b||(b={})),function(t){t.init=function(){t.PE_MGRS_STYLE_NEW=a.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=a.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=a.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=a.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=a.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},t.geog_to_mgrs_extended=function(t,e,n,r,i,s,o){a.ensureCache.prepare();let u=0;t&&(u=a.getPointer(t));const c=T(n),l=a.ensureFloat64(c),h=w(e,f.PE_MGRS_MAX),d=a.ensureInt32(h),p=a._pe_geog_to_mgrs_extended(u,e,l,r,i,s,d);if(p)for(let t=0;t<e;t++)o[t]=a.UTF8ToString(h[t]);return p},t.mgrs_to_geog_extended=function(t,e,n,r,i){a.ensureCache.prepare();let s=0;t&&(s=a.getPointer(t));const o=n.map(t=>a.ensureString(t)),u=a.ensureInt32(o),c=a.ensureFloat64(new Array(2*e)),l=a._pe_mgrs_to_geog_extended(s,e,u,r,c);return l&&j(i,e,c),l}}(P||(P={})),function(t){t.geog_to_usng=function(t,e,n,r,i,s,o){a.ensureCache.prepare();let u=0;t&&(u=a.getPointer(t));const c=T(n),l=a.ensureFloat64(c),h=w(e,f.PE_MGRS_MAX),d=a.ensureInt32(h),p=a._pe_geog_to_usng(u,e,l,r,i,s,d);if(p)for(let t=0;t<e;t++)o[t]=a.UTF8ToString(h[t]);return p},t.usng_to_geog=function(t,e,n,r){a.ensureCache.prepare();let i=0;t&&(i=a.getPointer(t));const s=n.map(t=>a.ensureString(t)),o=a.ensureInt32(s),u=a.ensureFloat64(new Array(2*e)),c=a._pe_usng_to_geog(i,e,o,u);return c&&j(r,e,u),c}}(x||(x={})),function(t){t.init=function(){t.PE_UTM_OPTS_NONE=a.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=a.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=a.PeNotationUtm.prototype.PE_UTM_OPTS_NS},t.geog_to_utm=function(t,e,n,r,i){a.ensureCache.prepare();let s=0;t&&(s=a.getPointer(t));const o=T(n),u=a.ensureFloat64(o),c=w(e,f.PE_UTM_MAX),l=a.ensureInt32(c),h=a._pe_geog_to_utm(s,e,u,r,l);if(h)for(let t=0;t<e;t++)i[t]=a.UTF8ToString(c[t]);return h},t.utm_to_geog=function(t,e,n,r,i){a.ensureCache.prepare();let s=0;t&&(s=a.getPointer(t));const o=n.map(t=>a.ensureString(t)),u=a.ensureInt32(o),c=a.ensureFloat64(new Array(2*e)),l=a._pe_utm_to_geog(s,e,u,r,c);return l&&j(i,e,c),l}}(I||(I={})),function(t){const e=new Map;t.init=function(){t.PE_PCSINFO_OPTION_NONE=a.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=a.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=a.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=a.PePCSInfo.prototype.PE_POLE_POINT},t.generate=function(n,r=t.PE_PCSINFO_OPTION_DOMAIN){let i,s;return e.has(n)&&(s=e.get(n),s[r]&&(i=s[r])),i||(i=a.PePCSInfo.prototype.generate(n,r),s||(s=[],e.set(n,s)),s[r]=i),i}}(S||(S={})),function(t){t.version_string=function(){return a.PeVersion.prototype.version_string()}}(M||(M={}));var N=Object.freeze({__proto__:null,get _pe(){return a},isLoaded:u,isSupported:c,load:l,get PeCSTransformations(){return h},get PeDefs(){return f},get PeFactory(){return d},get PeGCSExtent(){return m},get PeGTlistExtended(){return g},get PeGTlistExtendedEntry(){return _},get PeGTTransformations(){return y},get PeNotationDms(){return b},get PeNotationMgrs(){return P},get PeNotationUsng(){return x},get PeNotationUtm(){return I},get PePCSInfo(){return S},get PeVersion(){return M},_init:O});let R=0;class F{constructor(t=null){this.uid=R++,t?(this._wkt=void 0!==t.wkt?t.wkt:null,this._wkid=void 0!==t.wkid?t.wkid:-1,this._isInverse=void 0!==t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}static fromGE(t){const e=new F;return e._wkt=t.wkt,e._wkid=t.wkid,e._isInverse=t.isInverse,e}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=R++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=R++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=R++}getInverse(){const t=new F;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}var v=F;class A{constructor(t){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,t&&t.steps)for(const e of t.steps)e instanceof v?this.steps.push(e):this.steps.push(new v({wkid:e.wkid,wkt:e.wkt,isInverse:e.isInverse}))}static cacheKey(t,e){return[void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():"",void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():""].join(",")}static fromGE(t){const e=new A;let n="";for(const r of t.steps){const t=v.fromGE(r);e.steps.push(t),n+=t.uid.toString()+","}return e._cached_projection={},e._gtlistentry=null,e._chain=n,e}getInverse(){const t=new A;t.steps=[];for(let e=this.steps.length-1;e>=0;e--){const n=this.steps[e];t.steps.push(n.getInverse())}return t}getGTListEntry(){let t="";for(const e of this.steps)t+=e.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=t),this._gtlistentry}assignCachedGe(t,e,n){this._cached_projection[A.cacheKey(t,e)]=n}getCachedGeTransformation(t,e){let n="";for(const t of this.steps)n+=t.uid.toString()+",";n!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=n);const r=this._cached_projection[A.cacheKey(t,e)];return void 0===r?null:r}}var G=A;let C=null,B=null;function D(){return!!C&&u()}function Y(){return c()}let k=null;function Q(){return k||(k=Object(r.a)([l(),n.e(6).then(n.bind(null,386)).then((function(t){return t.g})),n.e(196).then(n.bind(null,520))]).then(([,t,{hydratedAdapter:e}])=>{B=e,C=t.default,C._enableProjection(N)}),k)}function X(t,e,n=null){return t instanceof Array?0===t.length?[]:Z(B,t,t[0].spatialReference,e,n):Z(B,[t],t.spatialReference,e,n)[0]}const L={};function Z(t,e,n,r,i=null){if(null===i){const t=G.cacheKey(n,r);void 0!==L[t]?i=L[t]:(null===(i=function(t,e,n=null){const r=C._getTransformation(B,t,e,n,null==n?void 0:n.spatialReference);return null!==r?G.fromGE(r):null}(n,r,null))&&(i=new G),L[t]=i)}return C._project(t,e,n,r,i)}},326:function(t,e,n){"use strict";n.d(e,"a",(function(){return x})),n.d(e,"b",(function(){return T})),n.d(e,"c",(function(){return k})),n.d(e,"d",(function(){return N})),n.d(e,"e",(function(){return Y})),n.d(e,"f",(function(){return w})),n.d(e,"g",(function(){return D})),n.d(e,"h",(function(){return j})),n.d(e,"i",(function(){return E}));n(20);var r=n(2),i=n(67),s=n(10),o=n(5),a=n(89),u=n(242),c=n(270),l=n(231),h=n(73),f=n(110),d=n(178),p=n(163),m=n(139),g=(n(271),n(211));function _(t,e){return t?e?4:3:e?3:2}function y(t,e,n,r,i){if(!t)return!1;const s=_(e,n),{coords:o,lengths:a}=t;let u=!1,c=0;for(const t of a)u=b(u,o,s,c,t,r,i),c+=t*s;return u}function b(t,e,n,r,i,s,o){let a=t,u=r;for(let t=r,c=r+i*n;t<c;t+=n){u=t+n,u===c&&(u=r);const i=e[t],l=e[t+1],h=e[u],f=e[u+1];(l<o&&f>=o||f<o&&l>=o)&&i+(o-l)/(f-l)*(h-i)<s&&(a=!a)}return a}const P=new i.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),x=Object.freeze({}),I=new p.a,S=new p.a,M=new p.a,O={esriGeometryPoint:m.j,esriGeometryPolyline:m.l,esriGeometryPolygon:m.k,esriGeometryMultipoint:m.i};function E(t,e,n,r=t.hasZ,i=t.hasM){const s=t.hasZ&&r,o=t.hasM&&i;if(n){const a=Object(m.r)(M,e,t.hasZ,t.hasM,"esriGeometryPoint",n,r,i);return Object(m.j)(a,s,o)}return Object(m.j)(e,s,o)}function w(t,e,n,r,i,s,o=e,a=n){const u=e&&o,c=n&&a,l=r?"coords"in r?r:r.geometry:null;if(!l)return null;if(i){let r=Object(m.n)(S,l,e,n,t,i,o,a);return s&&(r=Object(m.r)(M,r,u,c,t,s)),O[t](r,u,c)}if(s){const r=Object(m.r)(M,l,e,n,t,s,o,a);return O[t](r,u,c)}return Object(m.u)(I,l,e,n,o,a),O[t](I,u,c)}async function T(t,e,n){const{outFields:r,orderByFields:i,groupByFieldsForStatistics:s,outStatistics:o}=t;if(r)for(let t=0;t<r.length;t++)r[t]=r[t].trim();if(i)for(let t=0;t<i.length;t++)i[t]=i[t].trim();if(s)for(let t=0;t<s.length;t++)s[t]=s[t].trim();if(o)for(let t=0;t<o.length;t++)o[t].onStatisticField&&(o[t].onStatisticField=o[t].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),j(t,e,n)}async function j(t,e,n){if(!t)return null;let{where:i}=t;if(t.where=i=i&&i.trim(),(!i||/^1 *= *1$/.test(i)||e&&e===i)&&(t.where=null),!t.geometry)return t;let s=await async function(t){const{geometry:e,distance:n,units:r}=t;if(null==n||"vertexAttributes"in e)return e;const i=e.spatialReference,s=r?P.fromJSON(r):Object(f.d)(i),o=i&&(Object(a.e)(i)||Object(a.h)(i))?e:await Object(g.a)(i,a.a).then(()=>Object(g.b)(e,a.a));return(await B().then(t=>t.geodesicBuffer))(o.spatialReference,o,n,s)}(t);if(t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel){const{spatialReference:e}=t.geometry;s=Object(l.a)(s),s.spatialReference=e}t.geometry=s,await Object(g.a)(s.spatialReference,n);const o=(await Object(d.a)(Object(h.a)(s)))[0];if(Object(r.g)(o))throw x;const u=o.toJSON(),c=await Object(g.b)(u,u.spatialReference,n);if(!c)throw x;return c.spatialReference=n,t.geometry=c,t}function N(t){return t&&R in t?JSON.parse(JSON.stringify(t,F)):t}const R="_geVersion",F=(t,e)=>t!==R?e:void 0,v={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},A={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},G={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},C={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function B(){return Promise.all([n.e(6),n.e(27)]).then(n.bind(null,522))}function D(t,e,n,r,i){if(Object(h.g)(e)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t)){const t=Object(m.e)(new p.a,e,!1,!1);return Object(o.r)(e=>function(t,e,n,r){return y(t,e,n,r.coords[0],r.coords[1])}(t,!1,!1,e))}if(Object(h.g)(e)&&"esriGeometryMultipoint"===n){const n=Object(m.e)(new p.a,e,!1,!1);if("esriSpatialRelContains"===t)return Object(o.r)(t=>function(t,e,n,r,i,s){const o=_(i,s),{coords:a,lengths:u}=r;if(!u)return!1;for(let r=0,i=0;r<u.length;r++,i+=o)if(!y(t,e,n,a[i],a[i+1]))return!1;return!0}(n,!1,!1,t,r,i))}if(Object(h.d)(e)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t))return Object(o.r)(t=>Object(u.e)(e,w(n,r,i,t)));if(Object(h.d)(e)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===t)return Object(o.r)(t=>Object(u.d)(e,w(n,r,i,t)));if(Object(h.d)(e)&&"esriSpatialRelIntersects"===t){const t=Object(c.a)(n);return Object(o.r)(s=>t(e,w(n,r,i,s)))}return B().then(s=>{const o=s[v[t]].bind(null,e.spatialReference,e);return t=>o(w(n,r,i,t))})}async function Y(t,e,n){const{spatialRel:r,geometry:i}=t;if(i){if(!0!==A[r])throw new s.a("feature-store:unsupported-query","Unsupported query spatial relationship",{query:t});if(Object(a.f)(i.spatialReference)&&Object(a.f)(n)){if(!function(t){return!0===G[Object(h.c)(t)]}(i))throw new s.a("feature-store:unsupported-query","Unsupported query geometry type",{query:t});if(!function(t){return!0===C[t]}(e))throw new s.a("feature-store:unsupported-query","Unsupported layer geometry type",{query:t});if(t.outSR)return Object(g.a)(t.geometry&&t.geometry.spatialReference,t.outSR)}}}function k(t){if(Object(h.d)(t))return!0;if(Object(h.g)(t)){for(const e of t.rings){if(5!==e.length)return!1;if(e[0][0]!==e[1][0]||e[0][0]!==e[4][0]||e[2][0]!==e[3][0]||e[0][1]!==e[3][1]||e[0][1]!==e[4][1]||e[1][1]!==e[2][1])return!1}return!0}return!1}},329:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return o}));var r=n(3),i=n(8),s=n(148);function o(t){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?s.a:"esriGeometryPolyline"===t?s.c:s.b}}}function a(t,e){if(Object(r.a)("csp-restrictions"))return()=>({[e]:null,...t});try{let n=`this.${e} = null;`;for(const e in t)n+=`this${e.indexOf(".")?`["${e}"]`:"."+e} = ${JSON.stringify(t[e])};`;const r=new Function(n);return()=>new r}catch(n){return()=>({[e]:null,...t})}}function u(t={}){return[{name:"New Feature",description:"",prototype:{attributes:Object(i.a)(t)}}]}},330:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(331);function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this.toBBox=e:this._initFormat(e)),this.clear()}function s(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=m(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],u(i,t.leaf?r(s):s);return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,n,i,s){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,Object(r.a)(t,o,e,n,s),a.push(e,o,o,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!p(t,e))return n;for(var i,s,o,a,u=[];e;){for(i=0,s=e.children.length;i<s;i++)o=e.children[i],p(t,a=e.leaf?r(o):o)&&(e.leaf?n.push(o):d(t,a)?this._all(o,n):u.push(o));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var r,i,s,o,a=[];e;){for(r=0,i=e.children.length;r<i;r++)if(s=e.children[r],p(t,o=e.leaf?n(s):s)){if(e.leaf||d(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,o,a=this.data,u=this.toBBox(t),c=[],l=[];a||c.length;){if(a||(a=c.pop(),r=c[c.length-1],n=l.pop(),o=!0),a.leaf&&-1!==(i=s(t,a.children,e)))return a.children.splice(i,1),c.push(a),this._condense(c),this;o||a.leaf||!d(a,u)?r?(n++,a=r.children[n],o=!1):a=null:(c.push(a),l.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:c,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,s=n-e+1,a=this._maxEntries;if(s<=a)return o(i=m(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(i=m([])).leaf=!1,i.height=r;var u,c,l,h,f=Math.ceil(s/a),d=f*Math.ceil(Math.sqrt(a));for(g(t,e,n,d,this.compareMinX),u=e;u<=n;u+=d)for(g(t,u,l=Math.min(u+d-1,n),f,this.compareMinY),c=u;c<=l;c+=f)h=Math.min(c+f-1,l),i.children.push(this._build(t,c,h,r-1));return o(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,s,o,a,u,c,l,f,d,p;r.push(e),!e.leaf&&r.length-1!==n;){for(l=f=1/0,i=0,s=e.children.length;i<s;i++)u=h(o=e.children[i]),d=t,p=o,(c=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-u)<f?(f=c,l=u<l?u:l,a=o):c===f&&u<l&&(l=u,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),s=[],o=this._chooseSubtree(i,this.data,e,s);for(o.children.push(t),u(o,i);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(i,s,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),a=m(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,s,o,u,c,l,f,d,p,m,g,_,y;for(c=l=1/0,r=e;r<=n-e;r++)d=i=a(t,0,r,this.toBBox),p=s=a(t,r,n,this.toBBox),void 0,void 0,void 0,void 0,m=Math.max(d.minX,p.minX),g=Math.max(d.minY,p.minY),_=Math.min(d.maxX,p.maxX),y=Math.min(d.maxY,p.maxY),o=Math.max(0,_-m)*Math.max(0,y-g),u=h(i)+h(s),o<c?(c=o,f=r,l=u<l?u:l):o===c&&u<l&&(l=u,f=r);return f},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,s,o=this.toBBox,c=a(t,0,e,o),l=a(t,n-e,n,o),h=f(c)+f(l);for(i=e;i<n-e;i++)s=t.children[i],u(c,t.leaf?o(s):s),h+=f(c);for(i=n-e-1;i>=e;i--)s=t.children[i],u(l,t.leaf?o(s):s),h+=f(l);return h},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)u(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():o(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},331:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(77),i=Object(r.b)((function(t){var e;void 0!==(e=function(){function t(n,r,i,s,o){for(;s>i;){if(s-i>600){var a=s-i+1,u=r-i+1,c=Math.log(a),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(a-l)/a)*(u-a/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-u*l/a+h)),Math.min(s,Math.floor(r+(a-u)*l/a+h)),o)}var f=n[r],d=i,p=s;for(e(n,i,r),o(n[s],f)>0&&e(n,i,s);d<p;){for(e(n,d,p),d++,p--;o(n[d],f)<0;)d++;for(;o(n[p],f)>0;)p--}0===o(n[i],f)?e(n,i,p):e(n,++p,s),p<=r&&(i=p+1),r<=p&&(s=p-1)}}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}return function(e,r,i,s,o){t(e,r,i||0,s||e.length-1,o||n)}}())&&(t.exports=e)}))},332:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},380:function(t,e,n){"use strict";var r=n(8),i=n(2),s=n(10),o=n(5),a=n(89),u=n(202),c=n(73),l=n(96),h=n(110),f=n(105),d=n(243),p=n(55),m=n(104),g=n(332),_=n(186),y=n(211),b=n(333),P=n(137);const x=new class{constructor(t,e){this._cache=new b.a(t),this._invalidCache=new b.a(e)}get(t,e){const n=`${e.uid}:${t}`,r=this._cache.get(n);if(r)return r;if(void 0!==this._invalidCache.get(n))return null;try{const r=P.WhereClause.create(t,e);return this._cache.put(n,r),r}catch{return this._invalidCache.put(n,null),null}}}(50,500),I="feature-store:unsupported-query",S=Object(l.a)(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function M(t,e){return t?x.get(t,e):null}function O(t,e,n,r=!0){const i=[];for(const n of e)if("*"!==n&&!t.has(n))if(r){const e=E(n);try{const n=M(e,t);if(!n)throw new s.a(I,"invalid SQL expression",{where:e});if(!n.isStandardized)throw new s.a(I,"expression is not standard",{clause:n});O(t,n.fieldNames,"expression contains missing fields")}catch(t){const e=t&&t.details;if(e&&(e.clause||e.where))throw t;e&&e.missingFields?i.push(...e.missingFields):i.push(n)}}else i.push(n);if(i.length)throw new s.a(I,n,{missingFields:i})}function E(t){return t.split(" as ")[0]}function w(t,e){const n=e.get(t);return!!n&&!S.has(n.type)}var T=n(326),j=n(293),N=n(212),R=n(139),F=n(294),v=class{constructor(t,e,n){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=e;const r=t.outFields;if(r&&-1===r.indexOf("*")){this.outFields=r;let t=0;for(const e of r){const r=E(e),i=this.fieldsIndex.get(r),s=i?null:M(r,n),o=i?i.name:e.split(" as ")[1]||"FIELD_EXP_"+t++;this._fieldDataCache.set(e,{alias:o,clause:s})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach(t=>this.getAttributes(t)),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,e,n){const r=n?n.name:e;let i=null;return this._fieldDataCache.has(r)?i=this._fieldDataCache.get(r).clause:n||(i=M(e,this.fieldsIndex),this._fieldDataCache.set(r,{alias:r,clause:i})),n?this.featureAdapter.getAttribute(t,r):i.calculateValue(t,this.featureAdapter)}validateItem(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:M(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testFeature(t,this.featureAdapter)}validateItems(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:M(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testSet(t,this.featureAdapter)}_processAttributesForOutFields(t){const e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(t);const n={};for(const r of e){const{alias:e,clause:i}=this._fieldDataCache.get(r);n[e]=i?i.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return n}_processAttributesForDistinctValues(t){if(Object(i.g)(t)||!this.returnDistinctValues)return t;const e=this.outFields,n=[];if(e)for(const r of e){const{alias:e}=this._fieldDataCache.get(r);n.push(t[e])}else for(const e in t)n.push(t[e]);const r=`${(e||["*"]).join(",")}=${n.join(",")}`;let s=this._returnDistinctMap.get(r)||0;return this._returnDistinctMap.set(r,++s),s>1?null:t}};function A(t){return t.substr(24,12)+t.substr(19,4)+t.substr(16,2)+t.substr(14,2)+t.substr(11,2)+t.substr(9,2)+t.substr(6,2)+t.substr(4,2)+t.substr(2,2)+t.substr(0,2)}function G(t,e,n){return(n?t>e:t<e)?-1:(n?t<e:t>e)?1:0}function C(t,e,n){return n?e-t:t-e}function B(t,e,n,r){if(n&&"esriFieldTypeDate"===n.type){const n=new Date(t).getTime(),i=new Date(e).getTime();if(!isNaN(n)&&!isNaN(i))return C(n,i,r)}if("number"==typeof t&&"number"==typeof e)return C(t,e,r);if("string"==typeof t&&"string"==typeof e){const i=t.toUpperCase(),s=e.toUpperCase();return!n||"esriFieldTypeGUID"!==n.type&&"esriFieldTypeGlobalID"!==n.type?G(i,s,r):G(A(i),A(s),r)}return r?1:-1}class D{constructor(t,e,n){this.items=t,this.queryGeometry=e,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(t){const e=new v(t,this.featureAdapter,this.fieldsIndex);if(!t.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:n,having:r}=t;if(!(null==n?void 0:n.length))return 1;const i=new Map,s=new Map,o=new Set,a=t.outStatistics;for(const t of a){const{statisticType:a}=t,u="exceedslimit"!==a?t.onStatisticField:void 0;if(!s.has(u)){const t=[];for(const r of n){const n=this._getAttributeValues(e,r,i);t.push(n)}s.set(u,this._calculateUniqueValues(t))}const c=s.get(u);for(const t in c){const{data:n,items:i}=c[t],s=n.join(",");r&&!e.validateItems(i,r)||o.add(s)}}return o.size}createQueryResponse(t){let e;return e=t.outStatistics?t.outStatistics.some(t=>"exceedslimit"===t.statisticType)?this._createExceedsLimitQueryResponse(t):this._createStatisticsQueryResponse(t):this._createFeatureQueryResponse(t),t.returnQueryGeometry&&(Object(a.f)(t.outSR)&&!Object(a.c)(this.queryGeometry.spatialReference,t.outSR)?e.queryGeometry=Object(T.d)({spatialReference:t.outSR,...Object(y.b)(this.queryGeometry,this.queryGeometry.spatialReference,t.outSR)}):e.queryGeometry=Object(T.d)({spatialReference:t.outSR,...this.queryGeometry})),e}executeAttributesQuery(t){const e=M(t.where,this.fieldsIndex);if(!e)return Object(o.r)(this);if(e.isStandardized){let n=0;const r=[];for(const t of this.items)e.testFeature(t,this.featureAdapter)&&(r[n++]=t);const i=new D(r,this.queryGeometry,this);return i.definitionExpression=t.where,Object(o.r)(i)}return Object(o.h)(new TypeError("Where clause is not standardized"))}executeObjectIdsQuery(t){if(!t.objectIds||!t.objectIds.length)return Object(o.r)(this);const e=Object(l.a)(t.objectIds),n=this.featureAdapter.getObjectId;return Object(o.r)(new D(this.items.filter(t=>e.has(n(t))),this.queryGeometry,this))}executeTimeQuery(t){const e=Object(j.b)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!Object(i.h)(e))return Object(o.r)(this);const n=this.items.filter(e);return Object(o.r)(new D(n,this.queryGeometry,this))}filterLatest(){const{trackIdField:t,startTimeField:e,endTimeField:n}=this.timeInfo,r=n||e,i=new Map,s=this.featureAdapter.getAttribute;for(const e of this.items){const n=s(e,t),o=s(e,r),a=i.get(n);(!a||o>s(a,r))&&i.set(n,e)}const a=Object(N.e)(i);return Object(o.r)(new D(a,this.queryGeometry,this))}async project(t){if(!t||Object(a.c)(this.spatialReference,t))return this;const e=this.featureAdapter,n=(await Object(y.c)(this.items.map(t=>Object(T.f)(this.geometryType,this.hasZ,this.hasM,e.getGeometry(t))),this.spatialReference,t)).map((t,n)=>e.cloneWithGeometry(this.items[n],Object(R.d)(t,this.hasZ,this.hasM)));return new D(n,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}_sortFeatures(t,e,n){if(t.length>1&&e&&e.length)for(const r of e.reverse()){const e=r.split(" "),i=e[0],s=this.fieldsIndex.get(i),o=e[1]&&"desc"===e[1].toLowerCase();t.sort((t,e)=>B(n(t,i,s),n(e,i,s),s,o))}}_createFeatureQueryResponse(t){const e=this.items,{geometryType:n,hasM:r,hasZ:i,objectIdField:s,spatialReference:o}=this,{outFields:a,outSR:u,quantizationParameters:c,resultRecordCount:l,resultOffset:h,returnZ:f,returnM:d}=t,p=null!=l&&e.length>(h||0)+l,m=a&&(a.indexOf("*")>-1?[...this.fieldsIndex.fields]:a.map(t=>this.fieldsIndex.get(t)));return{exceededTransferLimit:p,features:this._createFeatures(t,e),fields:m,geometryType:n,hasM:r&&d,hasZ:i&&f,objectIdFieldName:s,spatialReference:Object(T.d)(u||o),transform:c&&Object(F.a)(c)||null}}_createFeatures(t,e){const n=new v(t,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:i}=this,{orderByFields:s,quantizationParameters:o,returnGeometry:a,returnCentroid:u,maxAllowableOffset:c,resultOffset:l,resultRecordCount:h,returnZ:f=!1,returnM:d=!1}=t,p=i&&f,m=r&&d;let g=[],_=0;const y=[...e];if(this._sortFeatures(y,s,(t,e,r)=>n.getFieldValue(t,e,r)),a||u){const t=Object(F.a)(o);if(a&&!u)for(const e of y)g[_++]={attributes:n.getAttributes(e),geometry:Object(T.f)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(e),c,t,p,m)};else if(!a&&u)for(const e of y)g[_++]={attributes:n.getAttributes(e),centroid:Object(T.i)(this,this.featureAdapter.getCentroid(e,this),t)};else for(const e of y)g[_++]={attributes:n.getAttributes(e),centroid:Object(T.i)(this,this.featureAdapter.getCentroid(e,this),t),geometry:Object(T.f)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(e),c,t,p,m)}}else for(const t of y){const e=n.getAttributes(t);e&&(g[_++]={attributes:e})}const b=l||0;if(null!=h){const t=b+h;g=g.slice(b,Math.min(g.length,t))}return g}_createExceedsLimitQueryResponse(t){let e=!1,n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;for(const e of t.outStatistics)if("exceedslimit"===e.statisticType){n=null!=e.maxPointCount?e.maxPointCount:Number.POSITIVE_INFINITY,r=null!=e.maxRecordCount?e.maxRecordCount:Number.POSITIVE_INFINITY,i=null!=e.maxVertexCount?e.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)e=this.items.length>n;else if(this.items.length>r)e=!0;else{const t=this.hasZ?this.hasM?4:3:this.hasM?3:2,n=this.featureAdapter;e=this.items.reduce((t,e)=>{const r=n.getGeometry(e);return t+(r&&r.coords.length||0)},0)/t>i}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(e)}}]}}_createStatisticsQueryResponse(t){const e={attributes:{}},n=[],r=new Map,i=new Map,s=new Map,o=new Map,a=new v(t,this.featureAdapter,this.fieldsIndex),u=t.outStatistics,{groupByFieldsForStatistics:c,having:l,orderByFields:h}=t,f=c&&c.length,d=!!f,p=d&&c[0],m=d&&!this.fieldsIndex.get(p);for(const t of u){const{outStatisticFieldName:u,statisticType:h}=t,g=t,_="exceedslimit"!==h?t.onStatisticField:void 0,y="percentile_disc"===h||"percentile_cont"===h,b=d&&1===f&&(_===p||m)&&"count"===h;if(d){if(!s.has(_)){const t=[];for(const e of c){const n=this._getAttributeValues(a,e,r);t.push(n)}s.set(_,this._calculateUniqueValues(t))}const t=s.get(_);for(const e in t){const{count:n,data:i,items:s,itemPositions:h}=t[e],f=i.join(",");if(!l||a.validateItems(s,l)){const t=o.get(f)||{attributes:{}};let e=null;if(b)e=n;else{const t=this._getAttributeValues(a,_,r),n=h.map(e=>t[e]);e=y&&"statisticParameters"in g?this._getPercentileValue(g,n):this._getStatisticValue(g,n)}t.attributes[u]=e,c.forEach((e,n)=>t.attributes[this.fieldsIndex.get(e)?e:"EXPR_"+(n+1)]=i[n]),o.set(f,t)}}}else{const t=this._getAttributeValues(a,_,r);e.attributes[u]=y&&"statisticParameters"in g?this._getPercentileValue(g,t):this._getStatisticValue(g,t,i)}n.push({name:u,alias:u,type:"esriFieldTypeDouble"})}const g=d?Object(N.e)(o):[e];return this._sortFeatures(g,h,(t,e)=>t.attributes[e]),{fields:n,features:g}}_getStatisticValue(t,e,n){const{onStatisticField:r,statisticType:i}=t,s=n&&n.has(r)?n.get(r):this._calculateStatistics(e);return n&&n.set(r,s),s["var"===i?"variance":i]}_getPercentileValue(t,e){const{onStatisticField:n,statisticParameters:r,statisticType:i}=t,{value:s,orderBy:o}=r,a="desc"===o,u=this.fieldsIndex.get(n),c=[...e].filter(t=>null!=t).sort((t,e)=>B(t,e,u,a));return this._calculatePercentile(c,s,"percentile_disc"===i)}_getAttributeValues(t,e,n){if(n.has(e))return n.get(e);const r=this.fieldsIndex.get(e),i=this.items.map(n=>t.getFieldValue(n,e,r));return n.set(e,i),i}_calculateStatistics(t){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=null,i=null,s=null,o=null;const a=[];let u=0;for(const i of t)"string"==typeof i?u++:null==i||isNaN(i)||(r+=i,e=Math.min(e,i),n=Math.max(n,i),a.push(i),u++);if(u){i=r/u;let t=0;for(const e of a)t+=Math.pow(e-i,2);o=u>1?t/(u-1):0,s=Math.sqrt(o)}else e=null,n=null;return{avg:i,count:u,max:n,min:e,stddev:s,sum:r,variance:o}}_calculateUniqueValues(t){const e={},n=this.items,r=n.length;for(let i=0;i<r;i++){const r=n[i],s=[];for(const e of t)s.push(e[i]);const o=s.join(",");null==e[o]?e[o]={count:1,data:s,items:[r],itemPositions:[i]}:(e[o].count++,e[o].items.push(r),e[o].itemPositions.push(i))}return e}_calculatePercentile(t,e,n){if(0===t.length)return null;if(e<=0)return t[0];if(e>=1)return t[t.length-1];const r=(t.length-1)*e,i=Math.floor(r),s=i+1,o=r%1,a=t[i],u=t[s];return s>=t.length||n||"string"==typeof a||"string"==typeof u?a:a*(1-o)+u*o}}var Y=D;const k=new Set,Q=new d.b(2e6);let X=0;const L=Object(_.b)(),Z=Object(_.b)();e.a=class{constructor(t){this.capabilities={query:g.a},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new d.a(X+++"$$",Q)),this.fieldsIndex=new m.a(t.fields),t.scheduler&&t.task&&(this._frameQueue=new p.a,this._frameTask=t.scheduler.registerTask(t.task,t=>this._update(t),()=>this._frameQueue.length>0))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const t=this.featureStore.fullBounds;return t?{xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:Object(T.d)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(j.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(t={},e){let n,i=Object(r.a)(t);try{i=await this._schedule(()=>Object(T.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i))}catch(t){if(t!==T.a)throw t;n=new Y([],null,this)}return n.createQueryResponse(i)}async executeQueryForCount(t={},e){let n,i=Object(r.a)(t);i.returnGeometry=!1,i.returnCentroid=!1,i.outSR=null;try{i=await this._schedule(()=>Object(T.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i))}catch(t){if(t!==T.a)throw t;return 0}return n.createQueryResponseForCount(i)}async executeQueryForExtent(t={},e){let n,i=Object(r.a)(t);const s=i.outSR;try{i=await this._schedule(()=>Object(T.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),i.returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i));const t=n.size;if(!t)return{count:t,extent:null};Object(_.i)(Z,_.a),this.featureStore.forEachBounds(n.items,t=>Object(_.e)(Z,t),L);const e={xmin:Z[0],ymin:Z[1],xmax:Z[3],ymax:Z[4],spatialReference:Object(T.d)(this.spatialReference)};this.hasZ&&isFinite(Z[2])&&isFinite(Z[5])&&(e.zmin=Z[2],e.zmax=Z[5]);const r=Object(y.b)(e,n.spatialReference,s);if(r.spatialReference=Object(T.d)(s||this.spatialReference),r.xmax-r.xmin==0){const t=Object(h.b)(r.spatialReference);r.xmin-=t,r.xmax+=t}if(r.ymax-r.ymin==0){const t=Object(h.b)(r.spatialReference);r.ymin-=t,r.ymax+=t}if(this.hasZ&&null!=r.zmin&&null!=r.zmax&&r.zmax-r.zmin==0){const t=Object(h.b)(r.spatialReference);r.zmin-=t,r.zmax+=t}return{count:t,extent:r}}catch(t){if(t===T.a)return{count:0,extent:null};throw t}}async executeQueryForIds(t={},e){return this.executeQueryForIdSet(t,e).then(t=>Object(l.c)(t))}async executeQueryForIdSet(t={},e){let n,i=Object(r.a)(t);i.returnGeometry=!1,i.returnCentroid=!1,i.outSR=null;try{i=await this._schedule(()=>Object(T.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i));const t=n.items,e=new Set;return await this._reschedule(()=>{for(const r of t)e.add(n.featureAdapter.getObjectId(r))}),e}catch(t){if(t===T.a)return new Set;throw t}}async executeQueryForLatestObservations(t={},e){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new s.a("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});let n,i=Object(r.a)(t);try{i=await this._schedule(()=>Object(T.b)(i,this.definitionExpression,this.spatialReference)),i=await this._reschedule(()=>this._checkQuerySupport(i)),n=await this._reschedule(()=>this._executeGeometryQuery(i)),n=await this._reschedule(()=>n.executeObjectIdsQuery(i)),n=await this._reschedule(()=>n.executeTimeQuery(i)),n=await this._reschedule(()=>n.executeAttributesQuery(i)),n=await this._reschedule(()=>n.filterLatest())}catch(t){if(t!==T.a)throw t;n=new Y([],null,this)}return n.createQueryResponse(i)}async _schedule(t){return this._frameQueue?this._frameQueue.push(t):t()}async _reschedule(t){return this._frameQueue?this._frameQueue.unshift(t):t()}_update(t){for(this._budget=t;!t.done&&this._frameQueue&&this._frameQueue.process();)t.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const t=[];this.featureStore.forEach(e=>t.push(e)),this._allItems=new Y(t,null,this)}return this._allItems}async _executeGeometryQuery(t){const{geometry:e,outSR:n,spatialRel:r}=t,s=Object(a.f)(n)&&!Object(a.c)(this.spatialReference,n),o=this._geometryQueryCache?s?JSON.stringify({geometry:e,spatialRelationship:r,outSpatialReference:n}):JSON.stringify({geometry:e,spatialRelationship:r}):null;if(o){const t=this._geometryQueryCache.get(o);if(!Object(i.i)(t))return t}const u=async e=>{if(s&&(t.returnGeometry||t.returnCentroid)){const t=await e.project(n);return o&&this._geometryQueryCache.put(o,t,t.size||1),t}return o&&this._geometryQueryCache.put(o,e,e.size||1),e};if(!e)return u(this._getAll());const c=this.featureAdapter;if("esriSpatialRelDisjoint"===r){const t=this._searchFeatures(this._getQueryBBoxes(e));if(!t.length)return u(this._getAll());let n,i;const s=new Set;for(const e of t)s.add(c.getObjectId(e));return await this._reschedule(()=>{let t=0;n=new Array(s.size),this.featureStore.forEach(e=>n[t++]=e),i=s}),u(await this._reschedule(async()=>{const t=await Object(T.g)(r,e,this.geometryType,this.hasZ,this.hasM);return new Y(await this._runSpatialFilter(n,e=>!i.has(c.getObjectId(e))||t(c.getGeometry(e))),e,this)}))}const l=this._searchFeatures(this._getQueryBBoxes(e));if(!l.length){const t=new Y([],e,this);return o&&this._geometryQueryCache.put(o,t,t.size||1),t}if(this._canExecuteSoloPass(e,t))return u(new Y(l,e,this));const h=await Object(T.g)(r,e,this.geometryType,this.hasZ,this.hasM),f=await this._runSpatialFilter(l,t=>h(c.getGeometry(t)));return u(new Y(f,e,this))}async _runSpatialFilter(t,e){if(!e)return t;if(!this._budget)return t.filter(t=>e(t));let n=0;const r=new Array,i=async()=>{for(;n<t.length;){const s=t[n];e(s)&&r.push(s),this._budget.done&&await this._reschedule(()=>i()),++n}};return this._reschedule(()=>i()).then(()=>r)}_canExecuteSoloPass(t,e){const{geometryType:n}=this,{spatialRel:r}=e;return Object(T.c)(t)&&("esriSpatialRelEnvelopeIntersects"===r||"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r||"esriSpatialRelWithin"===r))}_getQueryBBoxes(t){if(Object(T.c)(t)){if(Object(c.d)(t))return[Object(f.h)(t.xmin,t.ymin,t.xmax,t.ymax)];if(Object(c.g)(t))return t.rings.map(t=>Object(f.h)(Math.min(t[0][0],t[2][0]),Math.min(t[0][1],t[2][1]),Math.max(t[0][0],t[2][0]),Math.max(t[0][1],t[2][1])))}return[Object(u.a)(Object(f.c)(),t)]}_searchFeatures(t){for(const e of t)this.featureStore.forEachInBounds(e,t=>{k.add(t)});const e=new Array(k.size);let n=0;return k.forEach(t=>e[n++]=t),k.clear(),e}async _checkQuerySupport(t){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new s.a("feature-store:unsupported-query","Unsupported query options",{query:t});return Object(o.a)([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),Object(T.e)(t,this.geometryType,this.spatialReference),Object(y.a)(this.spatialReference,t.outSR)]).then(()=>t)}_checkAttributesQuerySupport(t){const{outFields:e,orderByFields:n,returnDistinctValues:r,outStatistics:i}=t,o=i?i.map(t=>t.outStatisticFieldName&&t.outStatisticFieldName.toLowerCase()):[];if(n&&n.length>0){const t=" asc",e=" desc",r=n.map(n=>{const r=n.toLowerCase();return r.indexOf(t)>-1?r.split(t)[0]:r.indexOf(e)>-1?r.split(e)[0]:n}).filter(t=>-1===o.indexOf(t));O(this.fieldsIndex,r,"orderByFields contains missing fields")}if(e&&e.length>0)O(this.fieldsIndex,e,"outFields contains missing fields");else if(r)throw new s.a("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:t});!function(t,e){if(!e)return!0;const n=x.get(e,t);if(!n)throw new s.a(I,"invalid SQL expression",{where:e});if(!n.isStandardized)throw new s.a(I,"where clause is not standard",{where:e});O(t,n.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,t.where)}async _checkStatisticsQuerySupport(t){const{outStatistics:e,groupByFieldsForStatistics:n,having:r}=t,i=n&&n.length,o=e&&e.length;if(r){if(!i||!o)throw new s.a("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});!function(t,e,n){if(!e)return!0;const r=x.get(e,t);if(!r)throw new s.a(I,"invalid SQL expression",{having:e});if(!r.isAggregate)throw new s.a(I,"having does not contain a valid aggregate function",{having:e});const i=r.fieldNames;if(O(t,i,"having contains missing fields"),!r.getExpressions().every(e=>{const{aggregateType:r,field:i}=e,s=t.has(i)&&t.get(i).name;return n.some(e=>{const{onStatisticField:n,statisticType:i}=e;return(t.has(n)&&t.get(n).name)===s&&i.toLowerCase().trim()===r})}))throw new s.a(I,"expressions in having should also exist in outStatistics",{having:e})}(this.fieldsIndex,r,e)}if(o){if(!function(t){return t.every(t=>"exceedslimit"!==t.statisticType)}(e))return;const r=e.map(t=>t.onStatisticField);O(this.fieldsIndex,r,"onStatisticFields contains missing fields"),i&&O(this.fieldsIndex,n,"groupByFieldsForStatistics contains missing fields");for(const n of e){const{onStatisticField:e,statisticType:r}=n;if("percentile_disc"!==r&&"percentile_cont"!==r||!("statisticParameters"in n)){if("count"!==r&&e&&w(e,this.fieldsIndex))throw new s.a("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:n,query:t})}else{const{statisticParameters:e}=n;if(!e)throw new s.a("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:n,query:t})}}}}}},498:function(t,e,n){"use strict";var r=n(2),i=n(7),s=n(10),o=n(112),a=n(105),u=n(139),c=n(186),l=n(3),h=(n(20),n(330));const f={minX:0,minY:0,maxX:0,maxY:0};class d{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=Object(h.a)(9,Object(l.a)("csp-restrictions")?t=>({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const t=new Array(this._idByBounds.size);let e=0;this._idByBounds.forEach((n,r)=>{t[e++]=r}),this._indexInvalid=!1,this._index.clear(),this._index.load(t)}else this._boundsToLoad.length&&(this._index.load(this._boundsToLoad.filter(t=>this._idByBounds.has(t))),this._boundsToLoad.length=0)}}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(t){const e=this._boundsById.get(t);this._boundsById.delete(t),e&&(this._idByBounds.delete(e),this._indexInvalid||this._index.remove(e))}forEachInBounds(t,e){this._loadIndex();for(const n of function(t,e){return f.minX=e[0],f.minY=e[1],f.maxX=e[2],f.maxY=e[3],t.search(f)}(this._index,t))e(this._idByBounds.get(n))}get(t){return this._boundsById.get(t)}has(t){return this._boundsById.has(t)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(t,e){if(!this._indexInvalid){const e=this._boundsById.get(t);e&&(this._index.remove(e),this._idByBounds.delete(e))}this._boundsById.set(t,e),e&&(this._idByBounds.set(e,t),this._indexInvalid||(this._boundsToLoad.push(e),this._boundsToLoad.length>5e4&&this._loadIndex()))}}var p=n(203),m=n(163),g=n(271);const _={getObjectId:t=>t.objectId,getAttributes:t=>t.attributes,getAttribute:(t,e)=>t.attributes[e],cloneWithGeometry:(t,e)=>new p.a(e,t.attributes,null,t.objectId),getGeometry:t=>t.geometry,getCentroid:(t,e)=>(t.centroid||(t.centroid=Object(g.a)(new m.a,t.geometry,e.hasZ,e.hasM)),t.centroid)};e.a=class{constructor(t){this.geometryInfo=t,this._boundsStore=new d,this._featuresById=new Map,this._markedIds=new Set,this.events=new o.a,this.featureAdapter=_}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){if(!this.numFeatures)return null;const t=Object(a.c)(a.a);return this._featuresById.forEach(e=>{const n=this._boundsStore.get(e.objectId);n&&(t[0]=Math.min(n[0],t[0]),t[1]=Math.min(n[1],t[1]),t[2]=Math.max(n[2],t[2]),t[3]=Math.max(n[3],t[3]))}),t}get storeStatistics(){let t=0;return this._featuresById.forEach(e=>{e.geometry&&e.geometry.coords&&(t+=e.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:t/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}add(t){this._add(t),this._emitChanged()}addMany(t){for(const e of t)this._add(e);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(t){const e=this._featuresById.get(t);return e?(this._remove(e),this._emitChanged(),e):null}removeManyById(t){this._boundsStore.invalidateIndex();for(const e of t){const t=this._featuresById.get(e);t&&this._remove(t)}this._emitChanged()}forEachBounds(t,e,n){for(const r of t){const t=this._boundsStore.get(r.objectId);t&&e(Object(c.g)(n,t))}}getFeature(t){return this._featuresById.get(t)}has(t){return this._featuresById.has(t)}forEach(t){this._featuresById.forEach(e=>t(e))}forEachInBounds(t,e){this._boundsStore.forEachInBounds(t,t=>{e(this._featuresById.get(t))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let t=!1;this._featuresById.forEach((e,n)=>{this._markedIds.has(n)||(t=!0,this._remove(e))}),this._markedIds.clear(),t&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(t){if(!t)return;const e=t.objectId;if(null==e)return void i.a.getLogger("esri.layers.graphics.data.FeatureStore").error(new s.a("featurestore:invalid-feature","feature id is missing",{feature:t}));const n=this._featuresById.get(e);let o;if(this._markedIds.add(e),n?(t.displayId=n.displayId,o=this._boundsStore.get(e),this._boundsStore.delete(e)):Object(r.h)(this.onFeatureAdd)&&this.onFeatureAdd(t),!t.geometry||!t.geometry.coords||!t.geometry.coords.length)return this._boundsStore.set(e,null),void this._featuresById.set(e,t);o=Object(u.o)(o||Object(a.c)(),t.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(e,o),this._featuresById.set(e,t)}_remove(t){return Object(r.h)(this.onFeatureRemove)&&this.onFeatureRemove(t),this._markedIds.delete(t.objectId),this._boundsStore.delete(t.objectId),this._featuresById.delete(t.objectId),t}}}});